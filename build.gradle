buildscript {
    dependencies {
        classpath rootProject.project(':yarn')
    }
}

plugins {
    id 'maven-publish'
}

import org.minecraftplus.gradle.tasks.mapping.ConvertMappings

repositories {
    maven { url = 'https://maven.minecraftplus.org/' }
    mavenLocal()
    mavenCentral()
}

def version = project(":yarn").tasks.getByName("downloadIntermediary").dest.name as String
version = version.split("-")[0]
logger.lifecycle("Version '{}'", version)

task convertMappings (type: ConvertMappings) {
    group = 'mapping build'
    dependsOn ":yarn:downloadIntermediary"
    dependsOn ":yarn:buildYarnTiny"

    intermediary = project(":yarn").tasks.getByName("downloadIntermediary").dest
    tiny =  project(":yarn").tasks.getByName("buildYarnTiny").v2Output
    output = file('mappings/' + version + '-v2.tiny')
}
